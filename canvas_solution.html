<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Solution - Build SH*T with Julia</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Build SH*T with Julia</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./mat_multip.html"><b>2</b> Matrix Multiplication</a></li>
<li><a class="menu-level-2" href="./mat_multip_problem.html"><b>2.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./mat_multip_solution.html"><b>2.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./bat_and_ball.html"><b>3</b> Bat and Ball</a></li>
<li><a class="menu-level-2" href="./bat_and_ball_problem.html"><b>3.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./bat_and_ball_solution.html"><b>3.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./camel_case.html"><b>4</b> Camel case</a></li>
<li><a class="menu-level-2" href="./camel_case_problem.html"><b>4.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./camel_case_solution.html"><b>4.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./toothpaste.html"><b>5</b> Toothpaste</a></li>
<li><a class="menu-level-2" href="./toothpaste_problem.html"><b>5.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./toothpaste_solution.html"><b>5.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./bile.html"><b>6</b> Bile</a></li>
<li><a class="menu-level-2" href="./bile_problem.html"><b>6.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./bile_solution.html"><b>6.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./recursion.html"><b>7</b> Recursion</a></li>
<li><a class="menu-level-2" href="./recursion_problem.html"><b>7.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./recursion_solution.html"><b>7.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./randomness.html"><b>8</b> Randomness</a></li>
<li><a class="menu-level-2" href="./randomness_problem.html"><b>8.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./randomness_solution.html"><b>8.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./the_doors.html"><b>9</b> The Doors</a></li>
<li><a class="menu-level-2" href="./the_doors_problem.html"><b>9.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./the_doors_solution.html"><b>9.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./progress_bar.html"><b>10</b> Progress Bar</a></li>
<li><a class="menu-level-2" href="./progress_bar_problem.html"><b>10.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./progress_bar_solution.html"><b>10.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./pascals_triangle.html"><b>11</b> Pascal’s triangle</a></li>
<li><a class="menu-level-2" href="./pascals_triangle_problem.html"><b>11.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./pascals_triangle_solution.html"><b>11.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./canvas.html"><b>12</b> Canvas</a></li>
<li><a class="menu-level-2" href="./canvas_problem.html"><b>12.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./canvas_solution.html"><b>12.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./tree.html"><b>13</b> Tree</a></li>
<li><a class="menu-level-2" href="./tree_problem.html"><b>13.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./tree_solution.html"><b>13.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./format_text.html"><b>14</b> Format text</a></li>
<li><a class="menu-level-2" href="./format_text_problem.html"><b>14.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./format_text_solution.html"><b>14.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./roman_numerals.html"><b>15</b> Roman numerals</a></li>
<li><a class="menu-level-2" href="./roman_numerals_problem.html"><b>15.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./roman_numerals_solution.html"><b>15.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./cheque.html"><b>16</b> Cheque</a></li>
<li><a class="menu-level-2" href="./cheque_problem.html"><b>16.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./cheque_solution.html"><b>16.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./binary.html"><b>17</b> Binary</a></li>
<li><a class="menu-level-2" href="./binary_problem.html"><b>17.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./binary_solution.html"><b>17.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./leap_year.html"><b>18</b> Leap year</a></li>
<li><a class="menu-level-2" href="./leap_year_problem.html"><b>18.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./leap_year_solution.html"><b>18.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./calendar.html"><b>19</b> Calendar</a></li>
<li><a class="menu-level-2" href="./calendar_problem.html"><b>19.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./calendar_solution.html"><b>19.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./prime_numbers.html"><b>20</b> Prime Numbers</a></li>
<li><a class="menu-level-2" href="./prime_numbers_problem.html"><b>20.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./prime_numbers_solution.html"><b>20.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./tic_tac_toe.html"><b>21</b> Tic-tac-toe</a></li>
<li><a class="menu-level-2" href="./tic_tac_toe_problem.html"><b>21.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./tic_tac_toe_solution.html"><b>21.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./touch_typing.html"><b>22</b> Touch Typing</a></li>
<li><a class="menu-level-2" href="./touch_typing_problem.html"><b>22.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./touch_typing_solution.html"><b>22.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./birthday.html"><b>23</b> Birthday</a></li>
<li><a class="menu-level-2" href="./birthday_problem.html"><b>23.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./birthday_solution.html"><b>23.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./compound_interest.html"><b>24</b> Compound interest</a></li>
<li><a class="menu-level-2" href="./compound_interest_problem.html"><b>24.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./compound_interest_solution.html"><b>24.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./mortgage.html"><b>25</b> Mortgage</a></li>
<li><a class="menu-level-2" href="./mortgage_problem.html"><b>25.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./mortgage_solution.html"><b>25.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./overpayment.html"><b>26</b> Overpayment</a></li>
<li><a class="menu-level-2" href="./overpayment_problem.html"><b>26.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./overpayment_solution.html"><b>26.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./logo.html"><b>27</b> Logo</a></li>
<li><a class="menu-level-2" href="./logo_problem.html"><b>27.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./logo_solution.html"><b>27.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./lattice_paths.html"><b>28</b> Lattice Paths</a></li>
<li><a class="menu-level-2" href="./lattice_paths_problem.html"><b>28.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./lattice_paths_solution.html"><b>28.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./transcription.html"><b>29</b> Transcription</a></li>
<li><a class="menu-level-2" href="./transcription_problem.html"><b>29.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./transcription_solution.html"><b>29.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./translation.html"><b>30</b> Translation</a></li>
<li><a class="menu-level-2" href="./translation_problem.html"><b>30.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./translation_solution.html"><b>30.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./stem_and_leaf.html"><b>31</b> Stem and Leaf Plot</a></li>
<li><a class="menu-level-2" href="./stem_and_leaf_problem.html"><b>31.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./stem_and_leaf_solution.html"><b>31.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./altruism.html"><b>32</b> Altruism</a></li>
<li><a class="menu-level-2" href="./altruism_problem.html"><b>32.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./altruism_solution.html"><b>32.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./shift.html"><b>33</b> Shift</a></li>
<li><a class="menu-level-2" href="./shift_problem.html"><b>33.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./shift_solution.html"><b>33.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./caesar.html"><b>34</b> Caesar</a></li>
<li><a class="menu-level-2" href="./caesar_problem.html"><b>34.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./caesar_solution.html"><b>34.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./vigenere.html"><b>35</b> Vigenere</a></li>
<li><a class="menu-level-2" href="./vigenere_problem.html"><b>35.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./vigenere_solution.html"><b>35.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./the-end.html"><b>36</b> The end</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="12.2" id="sec:canvas_solution"><span class="header-section-number">12.2</span> Solution</h2>
<p>The first question to answer is how to represent our <code>canvas</code>. Here, we’ll go with a matrix of strings which we will tint by placing space characters (<code>" "</code>) on a background colored with <a href="https://en.wikipedia.org/wiki/ANSI_escape_code#Colors">ANSI escape codes</a>.</p>
<pre><code>const PIXEL = &quot; &quot;
const COORD_ORIGIN = (1, 1) # origin or the coordinate system (row, col)

# &quot;\x1b[48:5:XXXm&quot; sets background color to XXX color code (256-color mode)
const BG_COLORS = Dict(
    :gray =&gt; &quot;\x1b[48:5:8m&quot;,
    :white =&gt; &quot;\x1b[48:5:15m&quot;,
    :red =&gt; &quot;\x1b[48:5:160m&quot;,
    :yellow =&gt; &quot;\x1b[48:5:11m&quot;,
    :blue =&gt; &quot;\x1b[48:5:12m&quot;,
    :darkblue =&gt; &quot;\x1b[48:5:20m&quot;,
    :green =&gt; &quot;\x1b[48:5:35m&quot;,
    :black =&gt; &quot;\x1b[48:5:0m&quot;,
    :brown =&gt; &quot;\x1b[48:5:88m&quot;,
)

# &quot;\x1b[0m&quot; resets background color to default value
# default color: &quot;\x1b[48:5:13m&quot; - pink
function getBgColor(color::Symbol, colors::Dict{Symbol, Str}=BG_COLORS)::Str
    return get(colors, color, &quot;\x1b[48:5:13m&quot;) * PIXEL * &quot;\x1b[0m&quot;
end

canvas = fill(getBgColor(:gray), 30, 60)</code></pre>
<p>Next, we want a way to properly display canvas (<code>printCanvas</code>) and to clear it (<code>clearCanvas!</code>). This last method will allow us to erase an incorrect drawing and try again and again if we need to.</p>
<pre><code>function printCanvas(cvs::Matrix{Str}=canvas)::Nothing
    nRows, _ = size(cvs)
    for r in 1:nRows
        println(cvs[r, :] |&gt; join)
    end
    return nothing
end

function clearCanvas!(cvs::Matrix{Str}=canvas)::Nothing
    cvs .= getBgColor(:gray)
    return nothing
end</code></pre>
<p>Now, to draw a picture we will need a few shapes, most likely: a rectangle, a triangle and an oval/circle. A shape will be represented as a vector of positions in our matrix (<code>canvas</code>). The positions need to be dyed with a specific color to visualize an object. Let’s start with a rectangle as this should be the easiest shape to obtain.</p>
<pre><code>const Pos = Tuple{Int, Int} # position, (row, col) in canvas

function getRectangle(width::Int, height::Int)::Vec{Pos}
    @assert width &gt;= 2 &quot;width must be &gt;= 2&quot;
    @assert height &gt;= 2 &quot;height must be &gt;= 2&quot;
    rectangle::Vec{Pos} = Vec{Pos}(undef, width * height)
    rowStart::Int, colStart::Int = COORD_ORIGIN
    i::Int = 1
    for row in rowStart:height, col in colStart:width
        rectangle[i] = (row, col)
        i += 1
    end
    return rectangle
end</code></pre>
<p>Each <code>rectangle</code> is represented as a vector of positions (<code>Vec{Pos}</code>). It will start at the origin of our coordinate system (<code>COORD_ORIGIN</code> - top left corner of our matrix). It will spread through as many <code>row</code>s and <code>col</code>umns as there are needed. Their numbers will be calculated based on the <code>height</code> (<code>startX:height</code>) and width (<code>startY:width</code>) of the <code>canvas</code>. Such a rectangle (the one that starts in the coordinate system origin point) is a good start, but to draw a picture we need to be able to place a shape in any location on the canvas.</p>
<pre><code># moves a shape by (nRows, nCols)
function nudge(shape::Vec{Pos}, by::Pos)::Vec{Pos}
    return map(pt -&gt; pt .+ by, shape)
end

# shifts a shape so that its anchor point starts where we want
function shift(shape::Vec{Pos}, anchor::Pos)::Vec{Pos}
    shift::Pos = anchor .- COORD_ORIGIN
    return nudge(shape, shift)
end

function getRectangle(width::Int, height::Int, topLeftCorner::Pos)::Vec{Pos}
    return shift(getRectangle(width, height), topLeftCorner)
end</code></pre>
<p>So far so good. Time to find a way to add the points that build our shape to the canvas (notice, that we only add the points that are inside of our canvas).</p>
<pre><code>function isWithinCanvas(point::Pos, cvs::Matrix{Str}=canvas)::Bool
    nRows, nCols = size(cvs)
    row, col = point
    return (0 &lt; row &lt;= nRows) &amp;&amp; (0 &lt; col &lt;= nCols)
end

function addPoints!(shape::Vec{Pos}, color::Symbol,
                    cvs::Matrix{Str}=canvas)::Nothing
    for pt in shape
        if isWithinCanvas(pt, cvs)
            cvs[pt...] = getBgColor(color)
        end
    end
    return nothing
end</code></pre>
<p>Once, we got it we can move to another shape, i.e. a triangle.</p>
<pre><code>function getTriangle(height::Int)::Vec{Pos}
    @assert height &gt; 1 &quot;height must be &gt; 1&quot;
    rowStart::Int, colStart::Int = COORD_ORIGIN
    lCol::Int = colStart # 1
    rCol::Int = colStart # 2
    triangle::Vec{Pos} = []
    for row in rowStart:height
        for col in lCol:rCol
            push!(triangle, (row, col))
        end
        lCol -= 1
        rCol += 1
    end
    return triangle
end

function getTriangle(height::Int, apex::Pos)::Vec{Pos}
    return shift(getTriangle(height), apex)
end</code></pre>
<p>Our triangle’s top starts with a pixel (<code>lCol</code> and <code>rCol</code> are initialized with the same value) in the origin of our coordinate system (<code>COORD_ORIGIN</code>). Then for each row (<code>for row in rowStart:height</code>) we dye each pixel between the left (<code>lCol</code>) and right (<code>rCol</code>) columns (inclusive-inclusive). The basis of the triangle is increased by one pixel on each side (<code>lCol -= 1</code> and <code>rCol += 1</code>) with each row we move down. Of note, we could have shortened the above snippet, e.g. by using a <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C</a>-like chained assignment (<code>lCol = rCol = colStart</code> instead of lines <code>#1</code> and <code>#2</code>). However, the longer version might be clearer and easier to follow in a head.</p>
<p>There’s one more shape left, a circle.</p>
<pre><code>function getCircle(radius::Int)::Vec{Pos}
    @assert 1 &lt; radius &lt; 6 &quot;radius must be in range [2-5]&quot;
    cols::Vec{Vec{Int}} = [collect((-1-r):(2+r)) for r in 0:(radius-1)]
    cols = [cols..., reverse(cols)...]
    triangle::Vec{Pos} = []
    rowStart::Int, _ = COORD_ORIGIN
    for row in rowStart:(radius*2)
        for col in cols[row]
            push!(triangle, (row, col))
        end
    end
    return triangle
end

function getCircle(radius::Int, topCenter::Pos)::Vec{Pos}
    return shift(getCircle(radius), topCenter)
end</code></pre>
<p>Here, we use a pattern similar to the one from the triangle. A circle is started in the top row (<code>rowStart</code>) with three columns (<code>collect((-1-r):(2+r))</code>). With every row down we increase the spread by 1 column in each direction (<code>r</code> changes by 1). Once, we are in half of our circle we decrease the number of colored columns. We achieve that by combining the previous <code>cols</code> with their <code>reverse</code>d version (<code>...</code> is a splat operator that, unpacks a vector by copying its elements).</p>
<p>Finally, we proceed to create our pixel-art graphics, e.g. by iteratively adding one element at a time with something like:</p>
<pre><code>clearCanvas!()
addPoints!(getSomeShape, :someColor)
printCanvas()</code></pre>
<p>and</p>
<pre><code>clearCanvas!()
addPoints!(getSomeShape, :someColor)
addPoints!(getAnotherShape, :someOtherColor)
printCanvas()</code></pre>
<p>Until we reach a satisfactory result with a code snippet similar to the one below:</p>
<pre><code>clearCanvas!()
addPoints!(getRectangle(60, 15, (16, 1)), :green) # meadow
addPoints!(getRectangle(60, 15), :blue) # sky
addPoints!(getRectangle(15, 8, (15, 21)), :white) # house walls
addPoints!(getRectangle(6, 6, (17, 28)), :brown) # doors
addPoints!(getRectangle(4, 2, (16, 22)), :darkblue) # window
addPoints!(getRectangle(4, 6, (8, 31)), :black) # chimney
addPoints!(getTriangle(8, (7, 28)), :red) # roof
addPoints!(getCircle(4, (2, 55)), :yellow) # sun
addPoints!(getCircle(3, (4, 7)), :white) # cloud, part 1
addPoints!(getCircle(4, (4, 14)), :white) # cloud, part 2
addPoints!(getCircle(2, (2, 18)), :white) # cloud, part 3
printCanvas()</code></pre>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./canvas_problem.html"><b>12.1</b> Problem</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-1" href="./tree.html"><b>13</b> Tree</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>