<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Solution - Build SH*T with Julia</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Build SH*T with Julia</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./mat_multip.html"><b>2</b> Matrix Multiplication</a></li>
<li><a class="menu-level-2" href="./mat_multip_problem.html"><b>2.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./mat_multip_solution.html"><b>2.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./bat_and_ball.html"><b>3</b> Bat and Ball</a></li>
<li><a class="menu-level-2" href="./bat_and_ball_problem.html"><b>3.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./bat_and_ball_solution.html"><b>3.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./toothpaste.html"><b>4</b> Toothpaste</a></li>
<li><a class="menu-level-2" href="./toothpaste_problem.html"><b>4.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./toothpaste_solution.html"><b>4.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./bile.html"><b>5</b> Bile</a></li>
<li><a class="menu-level-2" href="./bile_problem.html"><b>5.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./bile_solution.html"><b>5.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./prime_numbers.html"><b>6</b> Prime Numbers</a></li>
<li><a class="menu-level-2" href="./prime_numbers_problem.html"><b>6.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./prime_numbers_solution.html"><b>6.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./transcription.html"><b>7</b> Transcription</a></li>
<li><a class="menu-level-2" href="./transcription_problem.html"><b>7.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./transcription_solution.html"><b>7.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./translation.html"><b>8</b> Translation</a></li>
<li><a class="menu-level-2" href="./translation_problem.html"><b>8.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./translation_solution.html"><b>8.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./stem_and_leaf.html"><b>9</b> Stem and Leaf Plot</a></li>
<li><a class="menu-level-2" href="./stem_and_leaf_problem.html"><b>9.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./stem_and_leaf_solution.html"><b>9.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./the-end.html"><b>10</b> The end</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="6.2" id="sec:prime_numbers_solution"><span class="header-section-number">6.2</span> Solution</h2>
<h3 data-number="6.2.1" id="trial-division"><span class="header-section-number">6.2.1</span> Trial Division</h3>
<p>We begin by implementing <a href="https://en.wikipedia.org/wiki/Prime_number#Trial_division">trial division</a> algorithm. The above is a ‘brute force’ approach, namely we divide our candidate number, <code>n</code>, by a series of integers (remember, a prime number is an integer greater than 1 that is divisible only by 1 and itself). The method has a small improvement, i.e. the divisors are in the range from 2 up to <span class="math inline">\(\sqrt{n}\)</span>.</p>
<pre class="language-julia"><code>function isPrime(n::Int)::Bool
    if n &lt; 4
        return n &lt; 2 ? false : true
    end
    upTo::Int = sqrt(n) |&gt; ceil |&gt; Int
    for i in 2:upTo
        if n % i == 0
            return false
        end
    end
    return true
end</code></pre>
<pre class="output"><code>isPrime (generic function with 1 method)</code></pre>
<p>The function is pretty straightforward. The first two prime numbers are 2 and 3. Hence, the if <code>n &lt; 4</code> block that uses a <a href="https://b-lukaszuk.github.io/RJ_BS_eng/julia_language_decision_making.html#sec:ternary_expression">ternary expression</a>. Next, per algorithm we establish the maximum value of the divisor (<code>upto</code>). To that end we calculate <code>sqrt(n)</code>, round it to up to the next whole number (<code>ceil</code>) and convert it to integer (<code>Int</code>). Then, we test if the divisors in the range <code>2:upTo</code> divide our number <code>n</code> evenly (<code>n % i == 0</code>), if so we <code>return false</code> right away, otherwise the number is prime (<code>return true</code>).</p>
<p>With our <code>isPrime</code> ready, generating a sequence of primes is a breeze.</p>
<pre class="language-julia"><code>function getPrimesV1(upTo::Int)::Vec{Int}
    @assert upTo &gt; 1 &quot;upTo must be &gt; 1&quot;
    return filter(isPrime, 2:upTo)
end</code></pre>
<pre class="output"><code>getPrimesV1 (generic function with 1 method)</code></pre>
<p>All we had to do was to <code>filter</code> out primes from the sequence of numbers within the desired range <code>2:upTo</code>. Time for a simple test.</p>
<pre class="language-julia"><code># prime numbers up to 100 from:
# https://en.wikipedia.org/wiki/List_of_prime_numbers
primesFromWiki = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31,
    37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97]

getPrimesV1(100) == primesFromWiki</code></pre>
<p>true</p>
<p>Works like a charm.</p>
<h3 data-number="6.2.2" id="sieve-of-eratosthenes"><span class="header-section-number">6.2.2</span> Sieve of Eratosthenes</h3>
<p>Next, we will implement <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">the sieve of Eratosthenes algorithm</a> that finds primes by</p>
<blockquote>
<p>… iteratively marking as composite (i.e., not prime) the multiples of each prime, starting with the first prime number, 2.</p>
</blockquote>
<p>(see the Wikipedia’s page from the link above).</p>
<p>Let’s get down to it.</p>
<pre class="language-julia"><code>function getPrimesV2(upTo::Int)
    @assert upTo &gt; 1 &quot;upTo must be &gt; 1&quot;
    nums::Vec{Int} = 1:upTo |&gt; collect
    isPrimeTests::Vec{Bool} = ones(Bool, upTo)
    isPrimeTests[1] = false # first prime is: 2
    for num in nums
        if isPrimeTests[num]
            # numMultiples - local variable visible only in for loop
            numMultiples = (num*2):num:upTo # multiples of num
            isPrimeTests[numMultiples] .= false
        end
    end
    return nums[isPrimeTests]
end</code></pre>
<pre class="output"><code>getPrimesV2 (generic function with 1 method)</code></pre>
<p>This time we begin by defining two vectors <code>nums</code> which contains all the examined integers from a given range and <code>isPrimeTests</code> that contains indication of whether a number in <code>nums</code> is prime. Initially, all the numbers are considered to be primes (<code>ones(Bool, upTo)</code>) except for 1 (<code>isPrimeTests[1] = false</code>). Then, we examine every number (<code>num</code>) out of the candidates (<code>nums</code>). If a number is prime (<code>if isPrimeTests[num]</code>) we set all its multiples (<code>numMultiples</code>) as not primes (<code>false</code>) using broadcasting (<code>.</code>) with the assignment (<code>=</code>) operator. Once finished we return only the candidates that passed the test (<code>return nums[isPrimeTests]</code>) using boolean indexing of a vector.</p>
<p>Time for a simple test.</p>
<pre class="language-julia"><code>getPrimesV2(100) == primesFromWiki</code></pre>
<p>true</p>
<p>The test passed. Before we close this chapter let’s do our two methods give similar results.</p>
<pre class="language-julia"><code>getPrimesV1(1000) == getPrimesV2(1000)</code></pre>
<p>true</p>
<p>Good, both methods produce identical results.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./prime_numbers_problem.html"><b>6.1</b> Problem</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-1" href="./transcription.html"><b>7</b> Transcription</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>