<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Solution - Build SH*T with Julia</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Build SH*T with Julia</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./mat_multip.html"><b>2</b> Matrix Multiplication</a></li>
<li><a class="menu-level-2" href="./mat_multip_problem.html"><b>2.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./mat_multip_solution.html"><b>2.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./bat_and_ball.html"><b>3</b> Bat and Ball</a></li>
<li><a class="menu-level-2" href="./bat_and_ball_problem.html"><b>3.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./bat_and_ball_solution.html"><b>3.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./camel_case.html"><b>4</b> Camel case</a></li>
<li><a class="menu-level-2" href="./camel_case_problem.html"><b>4.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./camel_case_solution.html"><b>4.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./toothpaste.html"><b>5</b> Toothpaste</a></li>
<li><a class="menu-level-2" href="./toothpaste_problem.html"><b>5.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./toothpaste_solution.html"><b>5.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./bile.html"><b>6</b> Bile</a></li>
<li><a class="menu-level-2" href="./bile_problem.html"><b>6.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./bile_solution.html"><b>6.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./recursion.html"><b>7</b> Recursion</a></li>
<li><a class="menu-level-2" href="./recursion_problem.html"><b>7.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./recursion_solution.html"><b>7.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./randomness.html"><b>8</b> Randomness</a></li>
<li><a class="menu-level-2" href="./randomness_problem.html"><b>8.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./randomness_solution.html"><b>8.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./the_doors.html"><b>9</b> The Doors</a></li>
<li><a class="menu-level-2" href="./the_doors_problem.html"><b>9.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./the_doors_solution.html"><b>9.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./progress_bar.html"><b>10</b> Progress Bar</a></li>
<li><a class="menu-level-2" href="./progress_bar_problem.html"><b>10.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./progress_bar_solution.html"><b>10.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./pascals_triangle.html"><b>11</b> Pascal’s triangle</a></li>
<li><a class="menu-level-2" href="./pascals_triangle_problem.html"><b>11.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./pascals_triangle_solution.html"><b>11.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./canvas.html"><b>12</b> Canvas</a></li>
<li><a class="menu-level-2" href="./canvas_problem.html"><b>12.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./canvas_solution.html"><b>12.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./tree.html"><b>13</b> Tree</a></li>
<li><a class="menu-level-2" href="./tree_problem.html"><b>13.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./tree_solution.html"><b>13.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./format_text.html"><b>14</b> Format text</a></li>
<li><a class="menu-level-2" href="./format_text_problem.html"><b>14.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./format_text_solution.html"><b>14.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./roman_numerals.html"><b>15</b> Roman numerals</a></li>
<li><a class="menu-level-2" href="./roman_numerals_problem.html"><b>15.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./roman_numerals_solution.html"><b>15.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./cheque.html"><b>16</b> Cheque</a></li>
<li><a class="menu-level-2" href="./cheque_problem.html"><b>16.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./cheque_solution.html"><b>16.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./binary.html"><b>17</b> Binary</a></li>
<li><a class="menu-level-2" href="./binary_problem.html"><b>17.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./binary_solution.html"><b>17.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./leap_year.html"><b>18</b> Leap year</a></li>
<li><a class="menu-level-2" href="./leap_year_problem.html"><b>18.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./leap_year_solution.html"><b>18.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./calendar.html"><b>19</b> Calendar</a></li>
<li><a class="menu-level-2" href="./calendar_problem.html"><b>19.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./calendar_solution.html"><b>19.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./prime_numbers.html"><b>20</b> Prime Numbers</a></li>
<li><a class="menu-level-2" href="./prime_numbers_problem.html"><b>20.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./prime_numbers_solution.html"><b>20.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./tic_tac_toe.html"><b>21</b> Tic-tac-toe</a></li>
<li><a class="menu-level-2" href="./tic_tac_toe_problem.html"><b>21.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./tic_tac_toe_solution.html"><b>21.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./touch_typing.html"><b>22</b> Touch Typing</a></li>
<li><a class="menu-level-2" href="./touch_typing_problem.html"><b>22.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./touch_typing_solution.html"><b>22.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./birthday.html"><b>23</b> Birthday</a></li>
<li><a class="menu-level-2" href="./birthday_problem.html"><b>23.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./birthday_solution.html"><b>23.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./compound_interest.html"><b>24</b> Compound interest</a></li>
<li><a class="menu-level-2" href="./compound_interest_problem.html"><b>24.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./compound_interest_solution.html"><b>24.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./mortgage.html"><b>25</b> Mortgage</a></li>
<li><a class="menu-level-2" href="./mortgage_problem.html"><b>25.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./mortgage_solution.html"><b>25.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./overpayment.html"><b>26</b> Overpayment</a></li>
<li><a class="menu-level-2" href="./overpayment_problem.html"><b>26.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./overpayment_solution.html"><b>26.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./logo.html"><b>27</b> Logo</a></li>
<li><a class="menu-level-2" href="./logo_problem.html"><b>27.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./logo_solution.html"><b>27.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./lattice_paths.html"><b>28</b> Lattice Paths</a></li>
<li><a class="menu-level-2" href="./lattice_paths_problem.html"><b>28.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./lattice_paths_solution.html"><b>28.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./transcription.html"><b>29</b> Transcription</a></li>
<li><a class="menu-level-2" href="./transcription_problem.html"><b>29.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./transcription_solution.html"><b>29.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./translation.html"><b>30</b> Translation</a></li>
<li><a class="menu-level-2" href="./translation_problem.html"><b>30.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./translation_solution.html"><b>30.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./stem_and_leaf.html"><b>31</b> Stem and Leaf Plot</a></li>
<li><a class="menu-level-2" href="./stem_and_leaf_problem.html"><b>31.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./stem_and_leaf_solution.html"><b>31.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./altruism.html"><b>32</b> Altruism</a></li>
<li><a class="menu-level-2" href="./altruism_problem.html"><b>32.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./altruism_solution.html"><b>32.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./shift.html"><b>33</b> Shift</a></li>
<li><a class="menu-level-2" href="./shift_problem.html"><b>33.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./shift_solution.html"><b>33.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./caesar.html"><b>34</b> Caesar</a></li>
<li><a class="menu-level-2" href="./caesar_problem.html"><b>34.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./caesar_solution.html"><b>34.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./vigenere.html"><b>35</b> Vigenere</a></li>
<li><a class="menu-level-2" href="./vigenere_problem.html"><b>35.1</b> Problem</a></li>
<li><a class="menu-level-2" href="./vigenere_solution.html"><b>35.2</b> Solution</a></li>
<li><a class="menu-level-1" href="./the-end.html"><b>36</b> The end</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="6.2" id="sec:bile_solution"><span class="header-section-number">6.2</span> Solution</h2>
<p>To me the shape that resembles the droplet the most is <a href="https://en.wikipedia.org/wiki/Sphere">sphere</a>. Luckily, it also got well defined formulas for surface area and volume (see the link above), so this is what we will use in our solution.</p>
<pre class="language-julia"><code>struct Sphere
    radius::Flt
    Sphere(r::Flt) = r &lt;= 0 ? error(&quot;radius must be &gt; 0&quot;) : new(r)
end

# formula from Wikipedia
function getVolume(s::Sphere)::Flt
    return (4/3) * pi * s.radius^3
end

# formula from Wikipedia
function getSurfaceArea(s::Sphere)::Flt
    return 4 * pi * s.radius^2
end</code></pre>
<p>Now, let’s define a big lipid droplet with a radius of, let’s say, 10 [μm].</p>
<pre class="language-julia"><code>referenceDroplet = Sphere(10.0)</code></pre>
<p>In the next step we will split this big droplet into a few smaller ones of equal sizes. Splitting the volume is easy, we just divide it by the number of droplets. However, we need a way to determine the size (<code>radius</code>) of each small droplet. Let’s try to transform the formula for a sphere’s volume and see if we can get a radius from that.</p>
<p><span id="eq:sphere1"><span class="math display">\[ v = \frac{4}{3} * \pi * r^3 \qquad{(4)}\]</span></span></p>
<p>If a = b, then b = a, so we may swap sides.</p>
<p><span id="eq:sphere2"><span class="math display">\[ \frac{4}{3} * \pi * r^3 = v \qquad{(5)}\]</span></span></p>
<p>The multiplication is commutative (the order does not matter), i.e. 2 * 3 * 4 is the same as 4 * 3 * 2 or 2 * 4 * 3, therefore we can rearrange elements on the left side of Equation <a href="#eq:sphere2">5</a> to:</p>
<p><span id="eq:sphere3"><span class="math display">\[ r^3 * \frac{4}{3} * \pi = v \qquad{(6)}\]</span></span></p>
<p>Now, one by one we can move *<span class="math inline">\(\frac{4}{3}\)</span> and *<span class="math inline">\(\pi\)</span> to the right side of Equation <a href="#eq:sphere3">6</a>. Of course, we change the mathematical operation to the opposite (division instead of multiplication) and get:</p>
<p><span id="eq:sphere4"><span class="math display">\[ r^3 = v / \frac{4}{3} / \pi \qquad{(7)}\]</span></span></p>
<p>All that’s left to do is to move exponentiation (<span class="math inline">\(x^3\)</span>) to the right side of Equation <a href="#eq:sphere4">7</a> while changing it to the opposite mathematical operation (cube root, i.e. <span class="math inline">\(\sqrt[3]{x}\)</span>).</p>
<p><span id="eq:sphere5"><span class="math display">\[ r = \sqrt[3]{v / \frac{4}{3} / \pi} \qquad{(8)}\]</span></span></p>
<p>Now, you might wanted to quickly verify the solution using <code>Symbolic.symbolic_linear_solve</code> we met in Section <a href="./bat_and_ball_solution.html#sec:bat_and_ball_solution">3.2</a>. Unfortunately, we cannot use <code>r^3</code> (<code>r</code> to the 3rd power) as an argument (and solve for <code>r</code>), since then it wouldn’t be a linear equation (to be linear the maximum power must be equal to 1) required by <code>_linear_solve</code>. We could have used other, more complicated solver, but instead we will keep things simple and apply a little trick:</p>
<pre class="language-julia"><code>import Symbolics as Sym

# fraction - 4/3, p - π, r3 - r^3, v - volume
Sym.@variables fraction p r3 v
Sym.symbolic_linear_solve(fraction * p * r3 ~ v, r3)</code></pre>
<p>v / (fraction*p)</p>
<p>So, instead of writing the formula as it is, we just named our variables <code>fraction</code>, <code>p</code>, <code>r3</code> and <code>v</code>. Anyway, according to <code>Sym.symbolic_linear_solve</code> <span class="math inline">\(r^3 = v / (\frac{4}{3} * \pi)\)</span>, which is actually the same as Equation <a href="#eq:sphere4">7</a> above [since e.g. 18 / 2 / 3 == 18 / (2 * 3)]. Ergo, we may be fairly certain we correctly solved Equation <a href="#eq:sphere4">7</a> and therefore Equation <a href="#eq:sphere5">8</a>.</p>
<p>Once, we confirmed the validity of the formula in Equation <a href="#eq:sphere5">8</a>, all that’s left to do is to translate it into Julia code.</p>
<pre class="language-julia"><code>function getSphere(volume::Flt)::Sphere
    # cbrt - fn that calculates cube root of a number
    radius::Flt = cbrt(volume / (4/3) / pi)
    return Sphere(radius)
end</code></pre>
<blockquote>
<p><strong><em>Note:</em></strong> If there were no function for <span class="math inline">\(\sqrt[3]{x}\)</span> you could easily define it yourself with: <code>getCbrt(x) = x^(1/3)</code> (here I used a <a href="https://en.wikibooks.org/wiki/Introducing_Julia/Functions#Single_expression_functions">single expression function</a> for brevity) since <span class="math inline">\(\sqrt[n]{x} = x^{1/n}\)</span>.</p>
</blockquote>
<p>Once we got that figured out, we evaluate the total area of the droplets of different size.</p>
<pre class="language-julia"><code>nDroplets = [1, 4, 8, 12]
totalVolumes = repeat([getVolume(referenceDroplet)], length(nDroplets))
individualVolumes = totalVolumes ./ nDroplets
droplets = getSphere.(individualVolumes)
radii = map(s -&gt; s.radius, droplets)
individualSurfaceAreas = getSurfaceArea.(droplets)
totalSurfaceAreas = individualSurfaceAreas .* nDroplets</code></pre>
<p>This seemed like a breeze thanks to the <a href="https://b-lukaszuk.github.io/RJ_BS_eng/julia_language_repetition.html#sec:julia_language_dot_functions">dot operators</a>. We begin by by defining the <code>nDroplets</code>, i.e. the number of droplets that we will consider. Next, we divide their <code>totalVolumes</code> by their numbers (<code>nDroplets</code>) to get a volume of an individual droplet (<code>individualVolumes</code>). Based on the individual volumes we create the <code>droplets</code> of the appropriate radius (<code>getSphere.(individualVolumes)</code>). We also extract the <code>radii</code> for future use (the draw function below). Now, we calculate <code>individualSurfaceAreas</code> of our small droplets (<code>getSurfaceArea.(droplets)</code>) and then their <code>totalSurfaceAreas</code>. And we were able to achieve all that in only 7 lines of code.</p>
<p>Anyway, now, we can either examine the vectors (<code>totalSurfaceAreas</code>, <code>radii</code>, <code>nDroplets</code>, <code>individualVolumes</code>) one by one, or do one better and present them on a graph with e.g. CairoMakie (I’m not going to explain the code below, for reference see <a href="https://b-lukaszuk.github.io/RJ_BS_eng/">my previous book</a> or <a href="https://docs.makie.org/stable/tutorials/getting-started">CairoMakie tutorial</a>).</p>
<pre><code>import CairoMakie as Cmk

fig = Cmk.Figure();
ax = Cmk.Axis(fig[1, 1],
              title=&quot;Lipid droplet size vs. summaric surface area&quot;,
              xlabel=&quot;number of lipid droplets&quot;,
              ylabel=&quot;total surface area [μm²]&quot;, xticks=0:13);
Cmk.scatter!(ax, nDroplets, totalSurfaceAreas, markersize=radii .* 5,
             color=&quot;gold1&quot;, strokecolor=&quot;black&quot;);
Cmk.xlims!(ax, -3, 16);
Cmk.ylims!(ax, 800, 3000);
Cmk.text!(ax, nDroplets, totalSurfaceAreas .- 150,
    text=map(r -&gt; &quot;single droplet radius = $(round(r, digits=2)) [μm]&quot;,
             radii),
    fontsize=12, align=(:center, :center)
);
Cmk.text!(ax, nDroplets, totalSurfaceAreas .- 250,
          text=map((v, n) -&gt;
              &quot;volume ($n droplet/s) = $(round(Int, v)) [μm³]&quot;,
                   totalVolumes, nDroplets),
    fontsize=12, align=(:center, :center)
);
fig</code></pre>
<p>Behold.</p>
<figure id="fig:bile">
<img src="./images/bile.png" alt="Figure 1: Bile. Splitting a big lipid droplet into a few smaller ones and the effect it has on their total surface area." />
<figcaption aria-hidden="true">Figure 1: Bile. Splitting a big lipid droplet into a few smaller ones and the effect it has on their total surface area.</figcaption>
</figure>
<p>So it turns out that what they taught me in the school all those years ago is actually true. But only now I can finally see it. Nice.</p>
<blockquote>
<p><strong><em>Note:</em></strong> The above was an example of a geometrical property called <a href="https://en.wikipedia.org/wiki/Surface-area-to-volume_ratio">surface-to-volume-ratio</a> that applies to more than just the spheres and got its implications for many fields of science.</p>
</blockquote>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./bile_problem.html"><b>6.1</b> Problem</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-1" href="./recursion.html"><b>7</b> Recursion</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>